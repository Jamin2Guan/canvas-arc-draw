!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("core-js/modules/es6.function.bind"),require("core-js/modules/es6.array.for-each"),require("core-js/modules/es6.array.fill")):"function"==typeof define&&define.amd?define(["core-js/modules/es6.function.bind","core-js/modules/es6.array.for-each","core-js/modules/es6.array.fill"],e):(t=t||self).DragArc=e()}(this,(function(){"use strict";var t=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function e(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var i=function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t};return function(){function e(i){t(this,e),this.initParam(i),this.draw(this.value)}return i(e,[{key:"initParam",value:function(t){var e=t.el,i=t.startDeg,s=void 0===i?0:i,n=t.endDeg,h=void 0===n?1:n,o=t.innerColor,r=void 0===o?"#51e6b6":o,c=t.outColor,a=void 0===c?"#c0c0c0":c,u=t.innerLineWidth,l=void 0===u?1:u,d=t.outLineWidth,v=void 0===d?20:d,f=t.counterclockwise,g=void 0===f||f,x=t.slider,y=void 0===x?10:x,w=t.color,M=void 0===w?["#06dabc","#33aaff"]:w,b=t.sliderColor,k=void 0===b?"#fff":b,p=t.sliderBorderColor,D=void 0===p?"#33aaff":p,P=t.value,C=void 0===P?0:P,m=t.change,L=void 0===m?function(t){console.log(t)}:m,S=t.textShow,I=void 0===S||S;this.el=e,this.width=e.offsetWidth,this.height=e.offsetHeight,this.center=this.width/2,this.radius=this.width/2-30,this.initCanvas(e),this.startDeg=s,this.endDeg=h,this.innerColor=r,this.outColor=a,this.innerLineWidth=l,this.outLineWidth=v,this.counterclockwise=g,this.slider=y,this.color=M,this.sliderColor=k,this.sliderBorderColor=D,this.value=C,this.textShow=I,this.change=L,this.isDown=!1,this.event(e)}},{key:"initCanvas",value:function(t){this.canvas=document.createElement("canvas"),this.canvas.setAttribute("id","dragArc"),this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.width),t.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.isMobile=/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)}},{key:"draw",value:function(t){this.ctx.clearRect(0,0,this.width,this.width),this.ctx.save();var e=this.counterclockwise?Math.PI*(2-this.startDeg):Math.PI*this.startDeg,i=this.counterclockwise?Math.PI*(2-this.endDeg):Math.PI*this.endDeg;this.ctx.beginPath(),this.ctx.lineWidth=1,this.ctx.arc(this.center,this.center,this.radius-20,e,i,this.counterclockwise),this.ctx.strokeStyle=this.innerColor,this.ctx.stroke(),this.ctx.beginPath(),this.ctx.arc(this.center,this.center,this.radius,e,i,this.counterclockwise),this.ctx.strokeStyle=this.outColor,this.ctx.lineCap="round",this.ctx.lineWidth=this.outLineWidth,this.ctx.stroke();var s=this.valToDeg(t),n="String"==typeof this.color?this.color:this.setLinearGradient();this.ctx.beginPath(),this.ctx.arc(this.center,this.center,this.radius,e,s,this.counterclockwise),this.ctx.strokeStyle=n,this.ctx.lineCap="round",this.ctx.lineWidth=this.outLineWidth,this.ctx.stroke(),this.P=this.DegToXY(s),this.ctx.beginPath(),this.ctx.moveTo(this.center,this.center),this.ctx.arc(this.P.x,this.P.y,this.slider+5,0,2*Math.PI,!1),this.ctx.fillStyle=this.sliderBorderColor,this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(this.center,this.center),this.ctx.arc(this.P.x,this.P.y,this.slider,0,2*Math.PI,!1),this.ctx.fillStyle=this.sliderColor,this.ctx.fill(),this.textShow&&(this.ctx.font="".concat(this.center/4,"px serif"),this.ctx.fillStyle=n,this.ctx.textAlign="center",this.ctx.textBaseline="bottom",this.ctx.fillText(this.value,this.center,this.center))}},{key:"valToDeg",value:function(t){var e=(this.endDeg-this.startDeg)/100*t;return this.counterclockwise&&0!=e&&(e=2-e),((this.counterclockwise?2-this.startDeg:this.startDeg)+e)*Math.PI}},{key:"DegToXY",value:function(t){var e=2*Math.PI-t;return this.respotchangeXY({x:this.radius*Math.cos(e),y:this.radius*Math.sin(e)})}},{key:"spotchangeXY",value:function(t){var e,i=this;return{x:(e=t.x,e-i.center),y:function(t){return i.center-t}(t.y)}}},{key:"respotchangeXY",value:function(t){var e,i=this;return{x:(e=t.x,e+i.center),y:function(t){return i.center-t}(t.y)}}},{key:"setLinearGradient",value:function(){var t=this,e=this.ctx.createLinearGradient(0,0,0,this.width);return this.color.forEach((function(i,s){0==s?e.addColorStop(0,i):s==t.color.length-1?e.addColorStop(1,i):e.addColorStop(1/t.color.length*(s+1),i)})),e}},{key:"event",value:function(t){if(this.isMobile)return t.addEventListener("touchstart",this.OnMouseDown.bind(this),!1),t.addEventListener("touchmove",this.debounce(this.OnMouseMove.bind(this)),!1),void t.addEventListener("touchend",this.OnMouseUp.bind(this),!1);t.addEventListener("mousedown",this.OnMouseDown.bind(this),!1),t.addEventListener("mousemove",this.debounce(this.OnMouseMove.bind(this)),!1),t.addEventListener("mouseup",this.OnMouseUp.bind(this),!1)}},{key:"OnMouseMove",value:function(t){if(this.isDown){var e={};e.x=this.getx(t),e.y=this.gety(t);var i=this.spotchangeXY(e),s=this.XYToDeg(i.x,i.y),n=((s=this.counterclockwise?s:2*Math.PI-s)/Math.PI-this.startDeg)/(this.endDeg-this.startDeg)*100;n>=100&&(n=100),n<=0&&(n=0),Math.abs(n-this.value)>10||(this.draw(n),this.value!=Math.round(n)&&(this.value=Math.round(n),this.change(this.value)))}}},{key:"OnMouseDown",value:function(t){var e=this.getx(t),i=this.gety(t),s=this.P,n=s.x-this.slider-10,h=s.x+this.slider+10,o=s.y-this.slider-10,r=s.y+this.slider+10;this.isDown=n<e&&e<h&&o<i&&i<r}},{key:"OnMouseUp",value:function(){this.isDown=!1}},{key:"XYToDeg",value:function(t,e){var i,s=Math.atan(e/t);return t>=0&&e>=0&&(i=s),t<=0&&e>=0&&(i=s+Math.PI),t<=0&&e<=0&&(i=s+Math.PI),t>0&&e<0&&(i=s+2*Math.PI),i}},{key:"getx",value:function(t){return this.isMobile?t.touches[0].pageX-this.el.getBoundingClientRect().left:t.clientX-this.el.getBoundingClientRect().left}},{key:"gety",value:function(t){return this.isMobile?t.touches[0].pageY-this.el.getBoundingClientRect().top:t.clientY-this.el.getBoundingClientRect().top}},{key:"debounce",value:function(t){var e;return function(){var i=this,s=arguments;e&&clearTimeout(e),e=setTimeout((function(){t.apply(i,s)}),10)}}}]),e}()}));
