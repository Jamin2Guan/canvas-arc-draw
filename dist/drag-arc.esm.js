import"core-js/modules/es6.function.bind";import"core-js/modules/es6.array.for-each";import"core-js/modules/es6.array.fill";var t=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")};function i(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var e=function(t,e,s){return e&&i(t.prototype,e),s&&i(t,s),t},s=function(){function i(e){t(this,i),this.initParam(e),this.draw(this.value)}return e(i,[{key:"initParam",value:function(t){var i=t.el,e=t.startDeg,s=void 0===e?0:e,h=t.endDeg,n=void 0===h?1:h,o=t.innerColor,r=void 0===o?"#51e6b6":o,a=t.outColor,c=void 0===a?"#c0c0c0":a,l=t.innerLineWidth,u=void 0===l?1:l,d=t.outLineWidth,v=void 0===d?20:d,g=t.counterclockwise,f=void 0===g||g,x=t.slider,y=void 0===x?10:x,w=t.color,M=void 0===w?["#06dabc","#33aaff"]:w,k=t.sliderColor,b=void 0===k?"#fff":k,p=t.sliderBorderColor,P=void 0===p?"#33aaff":p,D=t.value,C=void 0===D?0:D,m=t.change,L=void 0===m?function(t){console.log(t)}:m,S=t.textShow,I=void 0===S||S;this.el=i,this.width=i.offsetWidth,this.height=i.offsetHeight,this.center=this.width/2,this.radius=this.width/2-30,this.initCanvas(i),this.startDeg=s,this.endDeg=n,this.innerColor=r,this.outColor=c,this.innerLineWidth=u,this.outLineWidth=v,this.counterclockwise=f,this.slider=y,this.color=M,this.sliderColor=b,this.sliderBorderColor=P,this.value=C,this.textShow=I,this.change=L,this.isDown=!1,this.event(i)}},{key:"initCanvas",value:function(t){this.canvas=document.createElement("canvas"),this.canvas.setAttribute("id","dragArc"),this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.width),t.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.isMobile=/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)}},{key:"draw",value:function(t){this.ctx.clearRect(0,0,this.width,this.width),this.ctx.save();var i=this.counterclockwise?Math.PI*(2-this.startDeg):Math.PI*this.startDeg,e=this.counterclockwise?Math.PI*(2-this.endDeg):Math.PI*this.endDeg;this.ctx.beginPath(),this.ctx.lineWidth=1,this.ctx.arc(this.center,this.center,this.radius-20,i,e,this.counterclockwise),this.ctx.strokeStyle=this.innerColor,this.ctx.stroke(),this.ctx.beginPath(),this.ctx.arc(this.center,this.center,this.radius,i,e,this.counterclockwise),this.ctx.strokeStyle=this.outColor,this.ctx.lineCap="round",this.ctx.lineWidth=this.outLineWidth,this.ctx.stroke();var s=this.valToDeg(t),h="String"==typeof this.color?this.color:this.setLinearGradient();this.ctx.beginPath(),this.ctx.arc(this.center,this.center,this.radius,i,s,this.counterclockwise),this.ctx.strokeStyle=h,this.ctx.lineCap="round",this.ctx.lineWidth=this.outLineWidth,this.ctx.stroke(),this.P=this.DegToXY(s),this.ctx.beginPath(),this.ctx.moveTo(this.center,this.center),this.ctx.arc(this.P.x,this.P.y,this.slider+5,0,2*Math.PI,!1),this.ctx.fillStyle=this.sliderBorderColor,this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(this.center,this.center),this.ctx.arc(this.P.x,this.P.y,this.slider,0,2*Math.PI,!1),this.ctx.fillStyle=this.sliderColor,this.ctx.fill(),this.textShow&&(this.ctx.font="".concat(this.center/4,"px serif"),this.ctx.fillStyle=h,this.ctx.textAlign="center",this.ctx.textBaseline="bottom",this.ctx.fillText(this.value,this.center,this.center))}},{key:"valToDeg",value:function(t){var i=(this.endDeg-this.startDeg)/100*t;return this.counterclockwise&&0!=i&&(i=2-i),((this.counterclockwise?2-this.startDeg:this.startDeg)+i)*Math.PI}},{key:"DegToXY",value:function(t){var i=2*Math.PI-t;return this.respotchangeXY({x:this.radius*Math.cos(i),y:this.radius*Math.sin(i)})}},{key:"spotchangeXY",value:function(t){var i,e=this;return{x:(i=t.x,i-e.center),y:function(t){return e.center-t}(t.y)}}},{key:"respotchangeXY",value:function(t){var i,e=this;return{x:(i=t.x,i+e.center),y:function(t){return e.center-t}(t.y)}}},{key:"setLinearGradient",value:function(){var t=this,i=this.ctx.createLinearGradient(0,0,0,this.width);return this.color.forEach((function(e,s){0==s?i.addColorStop(0,e):s==t.color.length-1?i.addColorStop(1,e):i.addColorStop(1/t.color.length*(s+1),e)})),i}},{key:"event",value:function(t){if(this.isMobile)return t.addEventListener("touchstart",this.OnMouseDown.bind(this),!1),t.addEventListener("touchmove",this.debounce(this.OnMouseMove.bind(this)),!1),void t.addEventListener("touchend",this.OnMouseUp.bind(this),!1);t.addEventListener("mousedown",this.OnMouseDown.bind(this),!1),t.addEventListener("mousemove",this.debounce(this.OnMouseMove.bind(this)),!1),t.addEventListener("mouseup",this.OnMouseUp.bind(this),!1)}},{key:"OnMouseMove",value:function(t){if(this.isDown){var i={};i.x=this.getx(t),i.y=this.gety(t);var e=this.spotchangeXY(i),s=this.XYToDeg(e.x,e.y),h=((s=this.counterclockwise?s:2*Math.PI-s)/Math.PI-this.startDeg)/(this.endDeg-this.startDeg)*100;h>=100&&(h=100),h<=0&&(h=0),Math.abs(h-this.value)>10||(this.draw(h),this.value!=Math.round(h)&&(this.value=Math.round(h),this.change(this.value)))}}},{key:"OnMouseDown",value:function(t){var i=this.getx(t),e=this.gety(t),s=this.P,h=s.x-this.slider-10,n=s.x+this.slider+10,o=s.y-this.slider-10,r=s.y+this.slider+10;this.isDown=h<i&&i<n&&o<e&&e<r}},{key:"OnMouseUp",value:function(){this.isDown=!1}},{key:"XYToDeg",value:function(t,i){var e,s=Math.atan(i/t);return t>=0&&i>=0&&(e=s),t<=0&&i>=0&&(e=s+Math.PI),t<=0&&i<=0&&(e=s+Math.PI),t>0&&i<0&&(e=s+2*Math.PI),e}},{key:"getx",value:function(t){return this.isMobile?t.touches[0].pageX-this.el.getBoundingClientRect().left:t.clientX-this.el.getBoundingClientRect().left}},{key:"gety",value:function(t){return this.isMobile?t.touches[0].pageY-this.el.getBoundingClientRect().top:t.clientY-this.el.getBoundingClientRect().top}},{key:"debounce",value:function(t){var i;return function(){var e=this,s=arguments;i&&clearTimeout(i),i=setTimeout((function(){t.apply(e,s)}),10)}}}]),i}();export default s;
